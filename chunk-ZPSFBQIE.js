import{f as g,g as p,h as I,ia as v,ja as w,k as f,ka as x,l as m,m as u,n as c,q as D,r as l,sa as C,t as b}from"./chunk-T6UPNXS7.js";function P(o,e){let t=e?.injector??c(D),r=new g(1),i=x(()=>{let n;try{n=o()}catch(s){v(()=>r.error(s));return}v(()=>r.next(n))},{injector:t,manualCleanup:!0});return t.get(l).onDestroy(()=>{i.destroy(),r.complete()}),r.asObservable()}function _(o,e){let r=!e?.manualCleanup?e?.injector?.get(l)??c(l):null,i=E(e?.equal),n;e?.requireSync?n=b({kind:0},{equal:i}):n=b({kind:1,value:e?.initialValue},{equal:i});let s,y=o.subscribe({next:a=>n.set({kind:1,value:a}),error:a=>{n.set({kind:2,error:a}),s?.()},complete:()=>{s?.()}});if(e?.requireSync&&n().kind===0)throw new m(601,!1);return s=r?.onDestroy(y.unsubscribe.bind(y)),w(()=>{let a=n();switch(a.kind){case 1:return a.value;case 2:throw a.error;case 0:throw new m(601,!1)}},{equal:e?.equal})}function E(o=Object.is){return(e,t)=>e.kind===1&&t.kind===1&&o(e.value,t.value)}var d=class o{DEFAULT_TTL=7200*1e3;constructor(){}setItem(e,t,r=this.DEFAULT_TTL){let i=Date.now()+r,n={data:t,expiry:i};try{localStorage.setItem(e,JSON.stringify(n))}catch(s){console.error("Error saving to localstorage",s)}}getItem(e){let t=localStorage.getItem(e);if(!t)return null;try{let r=JSON.parse(t);return Date.now()>r.expiry?(this.removeItem(e),null):r.data}catch(r){return console.error("Error parsing cached data",r),this.removeItem(e),null}}removeItem(e){localStorage.removeItem(e)}clear(){localStorage.clear()}static \u0275fac=function(t){return new(t||o)};static \u0275prov=u({token:o,factory:o.\u0275fac,providedIn:"root"})};var h={production:!1,API_URL:"https://api.weatherbit.io/v2.0",API_KEY:"177ffa1c3a194eb38fbffbbb6738cf45"};var M=class o{http=c(C);cache=c(d);baseUrl=h.API_URL;apiKey=h.API_KEY;getCurrentConditions(e){let t=`current_${e}`,r=this.cache.getItem(t);return r?p(r):this.http.get(`${this.baseUrl}/current`,{params:{postal_code:e,key:this.apiKey,units:"M"}}).pipe(I(i=>{let n=i.data;return n&&n.length>0?n[0]:null}),f(i=>this.cache.setItem(t,i)))}getForecast(e){let t=`forecast_${e}`,r=this.cache.getItem(t);return r?p(r):this.http.get(`${this.baseUrl}/forecast/daily`,{params:{postal_code:e,key:this.apiKey,days:5,units:"M"}}).pipe(f(i=>this.cache.setItem(t,i)))}static \u0275fac=function(t){return new(t||o)};static \u0275prov=u({token:o,factory:o.\u0275fac,providedIn:"root"})};export{P as a,_ as b,M as c};
