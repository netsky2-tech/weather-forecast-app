import{f as g,g as u,h as I,ia as v,ja as x,k as D,ka as C,n as f,o as m,p as l,q as c,qa as M,t as w,u as d,w as b}from"./chunk-R7K5JG2H.js";function _(i,e){let t=e?.injector??c(w),r=new g(1),o=C(()=>{let n;try{n=i()}catch(s){v(()=>r.error(s));return}v(()=>r.next(n))},{injector:t,manualCleanup:!0});return t.get(d).onDestroy(()=>{o.destroy(),r.complete()}),r.asObservable()}function $(i,e){let r=!e?.manualCleanup?e?.injector?.get(d)??c(d):null,o=j(e?.equal),n;e?.requireSync?n=b({kind:0},{equal:o}):n=b({kind:1,value:e?.initialValue},{equal:o});let s,y=i.subscribe({next:a=>n.set({kind:1,value:a}),error:a=>{n.set({kind:2,error:a}),s?.()},complete:()=>{s?.()}});if(e?.requireSync&&n().kind===0)throw new m(601,!1);return s=r?.onDestroy(y.unsubscribe.bind(y)),x(()=>{let a=n();switch(a.kind){case 1:return a.value;case 2:throw a.error;case 0:throw new m(601,!1)}},{equal:e?.equal})}function j(i=Object.is){return(e,t)=>e.kind===1&&t.kind===1&&i(e.value,t.value)}var p=class i{DEFAULT_TTL=7200*1e3;constructor(){}setItem(e,t,r=this.DEFAULT_TTL){let o=Date.now()+r,n={data:t,expiry:o};try{localStorage.setItem(e,JSON.stringify(n))}catch(s){console.error("Error saving to localstorage",s)}}getItem(e){let t=localStorage.getItem(e);if(!t)return null;try{let r=JSON.parse(t);return Date.now()>r.expiry?(this.removeItem(e),null):r.data}catch(r){return console.error("Error parsing cached data",r),this.removeItem(e),null}}removeItem(e){localStorage.removeItem(e)}clear(){localStorage.clear()}static \u0275fac=function(t){return new(t||i)};static \u0275prov=l({token:i,factory:i.\u0275fac,providedIn:"root"})};var h={production:!1,API_URL:"https://api.weatherbit.io/v2.0",API_KEY:"177ffa1c3a194eb38fbffbbb6738cf45"};var E=class i{http=c(M);cache=c(p);baseUrl=h.API_URL;apiKey=h.API_KEY;getCurrentConditions(e){let t=`current_${e}`,r=this.cache.getItem(t);return r?u(r):this.http.get(`${this.baseUrl}/current`,{params:{postal_code:e,key:this.apiKey,units:"M"}}).pipe(I(o=>{let n=o.data;return n&&n.length>0?n[0]:null}),D(o=>u(null)),f(o=>this.cache.setItem(t,o)))}getForecast(e){let t=`forecast_${e}`,r=this.cache.getItem(t);return r?u(r):this.http.get(`${this.baseUrl}/forecast/daily`,{params:{postal_code:e,key:this.apiKey,days:5,units:"M"}}).pipe(f(o=>this.cache.setItem(t,o)))}static \u0275fac=function(t){return new(t||i)};static \u0275prov=l({token:i,factory:i.\u0275fac,providedIn:"root"})};export{_ as a,$ as b,E as c};
